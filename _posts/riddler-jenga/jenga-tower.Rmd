---
title: "Can You Win Riddler Jenga?"
description: |
  I can - I think.
author:
  - name: Miha Gazvoda
    url: https://mihagazvoda.com
date: 02-20-2021
categories: 
  - data science
  - R
  - The Riddler
output:
  distill::distill_article:
    self_contained: false
---

This weekend I solved the Jenga problem from [The Riddler](https://fivethirtyeight.com/tag/the-riddler/). In this post, I described my solution. But first, the riddle:

> In the game of Jenga, you build a tower and then remove its blocks, one at a time, until the tower collapses. But in Riddler Jenga, you start with one block and then place more blocks on top of it, one at a time. 
>
> All the blocks have the same alignment (e.g., east-west). Importantly, whenever you place a block, its center is picked randomly along the block directly beneath it.  
>
> On average, how many blocks must you place so that your tower collapses â€” that is, until at least one block falls off?

For details, [visit Riddler's official page](https://fivethirtyeight.com/features/can-you-win-riddler-jenga/).

# Solution

Let's say we have Jenga tower (as on the sketch) and want to calculate whether it's stable.

<!-- TODO add sketch -->

But - what happens when the tower is not stable? It crashes. Why, how? Because - we can borrow this from physics - sum of forces $F_i$ or torques $\tau_i$ doesn't equal 0. So conditions for the Jenga tower to be stable are these:
$$
\sum F_i = 0  
$$
$$
\sum \tau_i = 0
$$

Forces are not problematic: only forces of gravity act on the bricks (you can see them on the sketch) in their centers. But they get (or at least could be) neutralized by the opposite force of the bricks below and table.

Falling Jenga tower actually *rotates*, not drops. The problem is torque. Potential axes of rotations are bricks' corners.^[It could also be brick center but you need huge force to break it.] They are marked with $\times$ on the sketch. Sum of torques has to be 0 for each of these axes. Torque is defined as:
$$
\tau = F \cdot r \cdot sin\theta
$$
where $\tau$ is torque, $r$ moment arm, $F$ applied force, and $\theta$  the angle between the force vector and the lever arm vector.^[Note that a $\tau$, $F$, and $r$ are in reality vectors bet here we are interested only in their magnitudes.] 

<!-- TODO add door sketch -->

To better understand torque, look at the sketch above. It represents doors from above that someone wants to open. She applies force at the door handle and torque is applied on the doors ligaments. TODO change ligaments



```{r}
library(purrr)
library(ggplot2)

calc_next_brick_center <- function(previous_brick_center) {
  previous_brick_center + runif(n = 1, min = -0.5, max = 0.5)
}

are_bricks_above_balanced <- function(brick_center, brick_centers_above) {
  abs(brick_center - mean(brick_centers_above)) < 0.5
}

get_tower_top_level <- function(...){
  brick_centers <- c(0)
  is_tower_balanced <- TRUE

  while(is_tower_balanced) {
    next_brick_center <- calc_next_brick_center(tail(brick_centers, n = 1))

    brick_centers <- c(brick_centers, next_brick_center)

    bricks_count <- length(brick_centers)

    is_tower_balanced <- all(map2_lgl(
      brick_centers[-bricks_count],
      map(2:bricks_count, ~brick_centers[.:bricks_count]),
      are_bricks_above_balanced
    ))

  }

  length(brick_centers)
}
```


```{r}
tower_heights <- map_int(1:1000, get_tower_top_level)

mean(tower_heights)

data.frame(tower_height = tower_heights) %>%
  ggplot(aes(x = tower_height, y = ..prop..)) +
  geom_bar()
```

